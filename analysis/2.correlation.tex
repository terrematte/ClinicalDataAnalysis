\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage[]{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\PassOptionsToPackage{hyphens}{url} % url is loaded by hyperref
\usepackage[unicode=true]{hyperref}
\hypersetup{
            pdftitle={A correlation analysis of clinical variables of TCGA-KIRC patients},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\usepackage{longtable,booktabs}
% Fix footnotes in tables (requires footnote package)
\IfFileExists{footnote.sty}{\usepackage{footnote}\makesavenoteenv{long table}}{}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{0}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

% set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother


\title{A correlation analysis of clinical variables of TCGA-KIRC patients}
\author{}
\date{\vspace{-2.5em}}

\begin{document}
\maketitle

This project contains a pipeline of clinical analysis of the Cancer
Genome Atlas Kidney Renal Clear Cell Carcinoma (TCGA-KIRC) data of
patients, from
\href{https://portal.gdc.cancer.gov/exploration?filters=\%7B\%22op\%22\%3A\%22and\%22\%2C\%22content\%22\%3A\%5B\%7B\%22op\%22\%3A\%22in\%22\%2C\%22content\%22\%3A\%7B\%22field\%22\%3A\%22cases.project.project_id\%22\%2C\%22value\%22\%3A\%5B\%22TCGA-KIRC\%22\%5D\%7D\%7D\%5D\%7D}{Genomic
Data Commons Data Portal} and
\href{https://www.cbioportal.org/study/summary?id=kirp_tcga}{cBioPortal}.

Previously, we presented \href{1.preprocessing.md}{an exploratory
preprocessing analysis}. In this section, Chi-squared test is applied to
compare two or more proportions of categorical variables and T-student
test to compare the means of numeric ones regardind the levels of
`Overall\_Survival\_Status'. The Hypoteis test is performed and p-value
indicates the strength of evidence in supportting the null hypothesis.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Set the packages of interest}
\NormalTok{packages =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"tidyverse"}\NormalTok{,}\StringTok{"skimr"}\NormalTok{,}\StringTok{"finalfit"}\NormalTok{,}\StringTok{"rstatix"}\NormalTok{, }\StringTok{"ggpubr"}\NormalTok{,}\StringTok{"GGally"}\NormalTok{, }\StringTok{"plotly"}\NormalTok{)}

\CommentTok{# if a package is installed, it will be loaded}
\CommentTok{# otherwise, the missing package(s) will be installed and loaded}
\NormalTok{package.check <-}\StringTok{ }\KeywordTok{lapply}\NormalTok{(packages, }\DataTypeTok{FUN =} \ControlFlowTok{function}\NormalTok{(x) \{}
  \ControlFlowTok{if}\NormalTok{ (}\OperatorTok{!}\KeywordTok{require}\NormalTok{(x, }\DataTypeTok{character.only =} \OtherTok{TRUE}\NormalTok{)) \{}
    \KeywordTok{install.packages}\NormalTok{(x, }\DataTypeTok{dependencies =} \OtherTok{TRUE}\NormalTok{)}
    \KeywordTok{library}\NormalTok{(x, }\DataTypeTok{character.only =} \OtherTok{TRUE}\NormalTok{)}
\NormalTok{  \}}
\NormalTok{\})}

\KeywordTok{suppressMessages}\NormalTok{(}\KeywordTok{library}\NormalTok{(}\StringTok{"tidyverse"}\NormalTok{))}
\KeywordTok{rm}\NormalTok{(packages)}
\KeywordTok{setwd}\NormalTok{(}\StringTok{"."}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\subsection{1. Importing data}\label{importing-data}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{kirc_clin <-}\StringTok{ }\KeywordTok{read_csv}\NormalTok{(}\StringTok{"data/kirc_clin.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\subsection{2. Taming data}\label{taming-data}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{kirc_clin <-}\StringTok{ }\NormalTok{kirc_clin }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{mutate_if}\NormalTok{(is.character, as.factor) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{patient_id =} \KeywordTok{as.character}\NormalTok{(patient_id),}
         \DataTypeTok{age =} \KeywordTok{as.integer}\NormalTok{(age),}
         \DataTypeTok{year_diagnose =} \KeywordTok{as.integer}\NormalTok{(year_diagnose))}

\CommentTok{# check }
\KeywordTok{glimpse}\NormalTok{(kirc_clin)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 537
## Columns: 32
## $ patient_id          <chr> "TCGA-3Z-A93Z", "TCGA-6D-AA2E", "TCGA-A3-3306",...
## $ age                 <int> 69, 68, 67, 66, 77, 57, 59, 57, 67, 70, 52, 51,...
## $ metastasis_stg      <fct> M0, MX, M0, M0, M0, M0, M0, M0, M0, M0, M0, M0,...
## $ neoplasm_ln_stg     <fct> N0, NX, N0, N0, N0, NX, N0, NX, N0, NX, NX, NX,...
## $ neoplasm_stg        <fct> Stage I, Stage I, Stage I, Stage III, Stage III...
## $ tumor_stg           <fct> T1, T1, T1, T3, T3, T1, T1, T2, T2, T1, T1, T1,...
## $ disease_free_mth    <dbl> 12.65, 11.89, 36.79, 47.17, 0.53, NA, NA, 49.05...
## $ disease_free_stt    <fct> DiseaseFree, DiseaseFree, DiseaseFree, DiseaseF...
## $ ethnicity           <fct> not hispanic/latino, not hispanic/latino, not h...
## $ frac_genome_alter   <dbl> 0.2240, 0.0000, 0.2316, 0.0494, 0.0844, 0.0883,...
## $ histology_grd       <fct> G2, G2, G3, G3, G2, G2, G3, G3, G2, G2, G1, G2,...
## $ hemoglobin          <fct> Normal, NA, NA, NA, Normal, Low, Low, NA, NA, N...
## $ neoadj_therapy      <fct> No, No, No, No, No, No, No, No, No, No, No, No,...
## $ prior_cancer        <fct> No, No, No, Yes, No, No, No, No, No, No, No, No...
## $ year_diagnose       <int> 2013, 2013, 2005, 2005, 2006, 2005, 2005, 2005,...
## $ tumor_lateral       <fct> Right, Right, Left, Right, Right, Right, Right,...
## $ long_dim            <dbl> NA, NA, 0.9, 1.0, 1.2, 1.7, 2.0, 1.7, 1.5, 1.5,...
## $ primer_ln_ind3      <fct> NO, NO, NO, YES, NO, NO, NA, NO, NO, NO, NO, NO...
## $ mutation_cnt        <dbl> NA, NA, NA, NA, 514, 56, 656, 577, 62, 537, 477...
## $ over_surv_mth       <dbl> 12.65, 11.89, 36.79, 47.17, 0.53, 39.13, 24.15,...
## $ over_surv_stt       <fct> LIVING, LIVING, LIVING, LIVING, LIVING, DECEASE...
## $ platelet            <fct> Normal, NA, NA, NA, Normal, NA, NA, NA, NA, NA,...
## $ tissue_prospect     <fct> YES, YES, NO, NO, NO, NO, NO, NO, NO, NO, NO, N...
## $ race                <fct> Black/African.american, Black/African.american,...
## $ tissue_retrospect   <fct> NO, NO, YES, YES, YES, YES, YES, YES, YES, YES,...
## $ serum_ca            <fct> Normal, NA, NA, NA, Normal, NA, NA, NA, NA, NA,...
## $ gender              <fct> Male, Female, Male, Male, Female, Male, Male, M...
## $ short_dim           <dbl> NA, NA, 0.4, 0.6, 0.4, 0.4, 0.8, 0.8, 0.3, 0.4,...
## $ second_long_dim     <dbl> NA, NA, 0.7, 0.8, 1.0, 1.0, 0.9, 0.8, 1.0, 1.1,...
## $ tissue_site         <fct> OTHERS, OTHERS, A, A, A, A, A, A, A, A, A, A, A...
## $ person_neoplasm_stt <fct> Tumor.Free, Tumor.Free, NA, With.Tumor, Tumor.F...
## $ wbc                 <fct> Normal, NA, NA, NA, Normal, NA, NA, NA, NA, NA,...
\end{verbatim}

\subsection{3.The dependent variable}\label{the-dependent-variable}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Check the number of levels. If greater than 2, it thas to run a ordinal logistic regression presents only two levels (otherwise, it has to run a ordinal logistic regression)}
\KeywordTok{table}\NormalTok{(kirc_clin}\OperatorTok{$}\NormalTok{over_surv_stt, }\DataTypeTok{exclude =} \OtherTok{NULL}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## DECEASED   LIVING 
##      177      360
\end{verbatim}

\subsection{4. Numeric variables
vs.~over\_surv\_stt}\label{numeric-variables-vs.over_surv_stt}

Correlation matrix - graphic visualization

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cols_numeric <-}\StringTok{ }\NormalTok{kirc_clin }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{select_if}\NormalTok{(is.numeric) }\OperatorTok{%>%}
\StringTok{  }\NormalTok{names}

\NormalTok{kirc_clin_numeric <-}\StringTok{ }\NormalTok{kirc_clin }\OperatorTok{%>%}
\StringTok{                      }\KeywordTok{select}\NormalTok{(}\KeywordTok{one_of}\NormalTok{(}\KeywordTok{c}\NormalTok{(cols_numeric, }\StringTok{"over_surv_stt"}\NormalTok{)))  }

\KeywordTok{levels}\NormalTok{(kirc_clin_numeric}\OperatorTok{$}\NormalTok{over_surv_stt) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"D"}\NormalTok{,}\StringTok{"L"}\NormalTok{)}

\KeywordTok{ggpairs}\NormalTok{(kirc_clin_numeric, }\DataTypeTok{columns =}\NormalTok{ cols_numeric, }
        \DataTypeTok{title=}\StringTok{"Correlation matrix"}\NormalTok{,               }
        \DataTypeTok{mapping=} \KeywordTok{aes}\NormalTok{(}\DataTypeTok{colour =}\NormalTok{ over_surv_stt), }
        \DataTypeTok{upper =} \KeywordTok{list}\NormalTok{(}\DataTypeTok{combo =} \KeywordTok{wrap}\NormalTok{(}\StringTok{"box_no_facet"}\NormalTok{, }\DataTypeTok{alpha=}\FloatTok{0.1}\NormalTok{), }
                     \DataTypeTok{continuous =} \KeywordTok{wrap}\NormalTok{(}\StringTok{"cor"}\NormalTok{, }\DataTypeTok{size =} \DecValTok{2}\NormalTok{, }\DataTypeTok{alignPercent =} \FloatTok{0.8}\NormalTok{)),}
        \DataTypeTok{lower =} \KeywordTok{list}\NormalTok{(}\DataTypeTok{continuous =} \KeywordTok{wrap}\NormalTok{(}\StringTok{"smooth"}\NormalTok{, }\DataTypeTok{alpha =} \FloatTok{0.3}\NormalTok{, }\DataTypeTok{size=}\FloatTok{0.2}\NormalTok{) )) }\OperatorTok{+}
\StringTok{        }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{panel.background =} \KeywordTok{element_rect}\NormalTok{(}\DataTypeTok{color =} \StringTok{"black"}\NormalTok{, }\DataTypeTok{size=}\FloatTok{0.5}\NormalTok{, }\DataTypeTok{fill=}\StringTok{"white"}\NormalTok{),}
          \DataTypeTok{panel.grid.major =} \KeywordTok{element_blank}\NormalTok{()) }
\end{Highlighting}
\end{Shaded}

\includegraphics{figs/render-unnamed-chunk-6-1.pdf}

Run multiple T-tests on over\_surv\_stt

Transform the data into long format

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Put all variables in the same column except `over_surv_stt`, the grouping variable}

\KeywordTok{levels}\NormalTok{(kirc_clin_numeric}\OperatorTok{$}\NormalTok{over_surv_stt) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"DECEASED"}\NormalTok{,}\StringTok{"LIVING"}\NormalTok{)}

\CommentTok{# Convert to Tidyverse}
\NormalTok{kirc_clin_numeric.long <-}\StringTok{ }\NormalTok{kirc_clin_numeric }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{pivot_longer}\NormalTok{(}\OperatorTok{-}\NormalTok{over_surv_stt, }\DataTypeTok{names_to =} \StringTok{"variables"}\NormalTok{, }\DataTypeTok{values_to =} \StringTok{"value"}\NormalTok{)}
\NormalTok{kirc_clin_numeric.long <-}\StringTok{ }\NormalTok{kirc_clin_numeric.long[}\OperatorTok{!}\KeywordTok{is.na}\NormalTok{(kirc_clin_numeric.long}\OperatorTok{$}\NormalTok{value), ]}
\NormalTok{kirc_clin_numeric.long}\OperatorTok{$}\NormalTok{value.log <-}\StringTok{ }\KeywordTok{log2}\NormalTok{(kirc_clin_numeric.long}\OperatorTok{$}\NormalTok{value}\OperatorTok{+}\DecValTok{1}\NormalTok{)}

\CommentTok{# OR}
\CommentTok{# kirc_clin_numeric.long <- kirc_clin_numeric %>% }
\CommentTok{#   gather(key = 'variables', value = 'value', -over_surv_stt, na.rm = TRUE) %>%}
\CommentTok{#     mutate(value.log = log2(kirc_clin_numeric.long$value+1))}

\NormalTok{kirc_clin_numeric.long }\OperatorTok{%>%}\StringTok{ }\KeywordTok{sample_n}\NormalTok{(}\DecValTok{6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 4
##   over_surv_stt variables           value value.log
##   <fct>         <chr>               <dbl>     <dbl>
## 1 LIVING        long_dim           1.6       1.38  
## 2 DECEASED      over_surv_mth     28.8       4.90  
## 3 LIVING        second_long_dim    1         1     
## 4 DECEASED      over_surv_mth     18.5       4.29  
## 5 LIVING        second_long_dim    0.7       0.766 
## 6 LIVING        frac_genome_alter  0.0342    0.0485
\end{verbatim}

Group the data by variables and compare over\_surv\_stt groups

Adjust the p-values and add significance levels

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{stat.test <-}\StringTok{ }\NormalTok{kirc_clin_numeric.long }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{group_by}\NormalTok{(variables) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{t_test}\NormalTok{(value }\OperatorTok{~}\StringTok{ }\NormalTok{over_surv_stt) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{adjust_pvalue}\NormalTok{(}\DataTypeTok{method =} \StringTok{"BH"}\NormalTok{) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{add_significance}\NormalTok{()}
\NormalTok{stat.test}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 9 x 11
##   variables .y.   group1 group2    n1    n2 statistic    df        p    p.adj
##   <chr>     <chr> <chr>  <chr>  <int> <int>     <dbl> <dbl>    <dbl>    <dbl>
## 1 age       value DECEA~ LIVING   177   360     4.89   348. 1.57e- 6 3.53e- 6
## 2 disease_~ value DECEA~ LIVING    78   360   -11.0    192. 4.76e-22 4.28e-21
## 3 frac_gen~ value DECEA~ LIVING   175   353     1.20   344. 2.33e- 1 2.62e- 1
## 4 long_dim  value DECEA~ LIVING   173   329     4.13   363. 4.51e- 5 8.12e- 5
## 5 mutation~ value DECEA~ LIVING   153   298    -1.83   429. 6.79e- 2 8.73e- 2
## 6 over_sur~ value DECEA~ LIVING   177   360    -7.32   451. 1.17e-12 3.51e-12
## 7 second_l~ value DECEA~ LIVING   173   329     4.06   288. 6.23e- 5 9.34e- 5
## 8 short_dim value DECEA~ LIVING   173   329     0.478  345. 6.33e- 1 6.33e- 1
## 9 year_dia~ value DECEA~ LIVING   177   360    -8.90   377. 2.41e-17 1.08e-16
## # ... with 1 more variable: p.adj.signif <chr>
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Create the plot on logscale}
\NormalTok{myplot <-}\StringTok{ }\KeywordTok{ggboxplot}\NormalTok{(}
\NormalTok{  kirc_clin_numeric.long, }\DataTypeTok{x =} \StringTok{"over_surv_stt"}\NormalTok{, }\DataTypeTok{y =} \StringTok{"value.log"}\NormalTok{,}
  \DataTypeTok{fill =} \StringTok{"over_surv_stt"}\NormalTok{, }\DataTypeTok{palette =} \StringTok{"npg"}\NormalTok{, }\DataTypeTok{legend =} \StringTok{"none"}\NormalTok{, }
  \DataTypeTok{ggtheme =} \KeywordTok{theme_pubr}\NormalTok{(}\DataTypeTok{border =} \OtherTok{TRUE}\NormalTok{)}
\NormalTok{  ) }\OperatorTok{+}
\StringTok{  }\KeywordTok{facet_wrap}\NormalTok{(}\OperatorTok{~}\NormalTok{variables)}

\CommentTok{# Add statistical test p-values}
\CommentTok{# OBS: different p-values over vaule vs. log.value!! }
\NormalTok{stat.test <-}\StringTok{ }\NormalTok{stat.test }\OperatorTok{%>%}\StringTok{ }\KeywordTok{add_xy_position}\NormalTok{(}\DataTypeTok{x =} \StringTok{"over_surv_stt"}\NormalTok{)}
\NormalTok{myplot }\OperatorTok{+}\StringTok{ }\KeywordTok{stat_pvalue_manual}\NormalTok{(stat.test, }\DataTypeTok{label =} \StringTok{"p.adj.signif"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figs/render-unnamed-chunk-9-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Group the data by variables and do a graph for each variable}
\NormalTok{graphs <-}\StringTok{ }\NormalTok{kirc_clin_numeric.long }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{group_by}\NormalTok{(variables) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{doo}\NormalTok{(}
    \OperatorTok{~}\KeywordTok{ggboxplot}\NormalTok{(}
      \DataTypeTok{data =}\NormalTok{., }\DataTypeTok{x =} \StringTok{"over_surv_stt"}\NormalTok{, }\DataTypeTok{y =} \StringTok{"value"}\NormalTok{,}
      \DataTypeTok{fill =} \StringTok{"over_surv_stt"}\NormalTok{, }\DataTypeTok{palette =} \StringTok{"npg"}\NormalTok{, }\DataTypeTok{legend =} \StringTok{"none"}\NormalTok{,}
      \DataTypeTok{ggtheme =} \KeywordTok{theme_pubr}\NormalTok{()}
\NormalTok{      )  }\OperatorTok{+}
\StringTok{      }\KeywordTok{geom_jitter}\NormalTok{(}\DataTypeTok{width =} \FloatTok{0.05}\NormalTok{, }\DataTypeTok{alpha =} \FloatTok{0.2}\NormalTok{, }\DataTypeTok{color =} \StringTok{"orange"}\NormalTok{), }
    \DataTypeTok{result =} \StringTok{"plots"}
\NormalTok{  )}
\NormalTok{graphs}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 9 x 2
##   variables         plots 
##   <chr>             <list>
## 1 age               <gg>  
## 2 disease_free_mth  <gg>  
## 3 frac_genome_alter <gg>  
## 4 long_dim          <gg>  
## 5 mutation_cnt      <gg>  
## 6 over_surv_mth     <gg>  
## 7 second_long_dim   <gg>  
## 8 short_dim         <gg>  
## 9 year_diagnose     <gg>
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Add statitistical tests to each corresponding plot}
\CommentTok{# variables <- graphs$variables}
\CommentTok{# for(i in 1:length(variables))\{}
\CommentTok{#   graph.i <- graphs$plots[[i]] + }
\CommentTok{#     labs(title = variables[i]) +}
\CommentTok{#     #stat_pvalue_manual(stat.test[i, ], label = "p.adj.signif")}
\CommentTok{#   print(graph.i)}
\CommentTok{# \}}
\CommentTok{# Error in print(graph.i) : objeto 'graph.i' não encontrado}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# ggplot(kirc_clin, aes(age, fill= over_surv_stt)) +}
\CommentTok{#   geom_histogram(bins = 15, position = "dodge")}
\CommentTok{# t.test(kirc_clin$age ~ kirc_clin$over_surv_stt) }
\CommentTok{# }
\CommentTok{# ggplot(kirc_clin, aes(year_diagnose, fill= over_surv_stt)) +}
\CommentTok{#   geom_histogram(bins = 15, position = "dodge")}
\CommentTok{# t.test(kirc_clin$year_diagnose ~ kirc_clin$over_surv_stt) }
\CommentTok{# }
\CommentTok{# ggplot(kirc_clin, aes(x=over_surv_stt, y=disease_free_mth)) +}
\CommentTok{#   geom_boxplot(width = .5) +}
\CommentTok{#   geom_jitter(width = 0.05, alpha = 0.2, color = "orange")}
\CommentTok{# t.test(kirc_clin$disease_free_mth ~ kirc_clin$over_surv_stt)}
\CommentTok{# }
\CommentTok{# ggplot(kirc_clin, aes(x=over_surv_stt, y=frac_genome_alter)) +}
\CommentTok{#   geom_boxplot(width = .5) +}
\CommentTok{#   geom_jitter(width = 0.05, alpha = 0.2, color = "orange")}
\CommentTok{# t.test(kirc_clin$frac_genome_alter ~ kirc_clin$over_surv_stt)}
\CommentTok{# }
\CommentTok{# ggplot(kirc_clin, aes(x=over_surv_stt, y=long_dim)) +}
\CommentTok{#   geom_boxplot(width = .5) +}
\CommentTok{#   geom_jitter(width = 0.05, alpha = 0.2, color = "orange")}
\CommentTok{# t.test(kirc_clin$long_dim ~ kirc_clin$over_surv_stt)}
\CommentTok{# }
\CommentTok{# ggplot(kirc_clin, aes(x=over_surv_stt, y=mutation_cnt)) +}
\CommentTok{#   geom_boxplot(width = .5) +}
\CommentTok{#   geom_jitter(width = 0.05, alpha = 0.2, color = "orange")}
\CommentTok{# t.test(kirc_clin$mutation_cnt ~ kirc_clin$over_surv_stt)}
\CommentTok{# }
\CommentTok{# ggplot(kirc_clin, aes(x=over_surv_stt, y=over_surv_mth)) +}
\CommentTok{#   geom_boxplot(width = .5) +}
\CommentTok{#   geom_jitter(width = 0.05, alpha = 0.2, color = "orange")}
\CommentTok{# t.test(kirc_clin$over_surv_mth ~ kirc_clin$over_surv_stt)}
\CommentTok{# }
\CommentTok{# ggplot(kirc_clin, aes(x=over_surv_stt, y=short_dim)) +}
\CommentTok{#   geom_boxplot(width = .5) +}
\CommentTok{#   geom_jitter(width = 0.05, alpha = 0.2, color = "orange")}
\CommentTok{# t.test(kirc_clin$short_dim ~ kirc_clin$over_surv_stt)}
\CommentTok{# }
\CommentTok{# ggplot(kirc_clin, aes(x=over_surv_stt, y=second_long_dim)) +}
\CommentTok{#   geom_boxplot(width = .5) +}
\CommentTok{#   geom_jitter(width = 0.05, alpha = 0.2, color = "orange")}
\CommentTok{# t.test(kirc_clin$second_long_dim ~ kirc_clin$over_surv_stt)}
\end{Highlighting}
\end{Shaded}

Summary for continuous explanatory variables use a parametric or
non-parametric test??

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{explanatory_num <-}\StringTok{ }\NormalTok{kirc_clin }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{select}\NormalTok{(}\OperatorTok{-}\NormalTok{over_surv_stt) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{select_if}\NormalTok{(is.numeric) }\OperatorTok{%>%}
\StringTok{  }\NormalTok{names}
\NormalTok{dependent <-}\StringTok{ 'over_surv_stt'}

\NormalTok{table_num <-}\StringTok{ }\NormalTok{kirc_clin }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{summary_factorlist}\NormalTok{(dependent, explanatory_num, }\DataTypeTok{p=}\OtherTok{TRUE}\NormalTok{, }
                     \DataTypeTok{add_dependent_label=}\OtherTok{TRUE}\NormalTok{,  }\DataTypeTok{na_include =} \OtherTok{TRUE}\NormalTok{)}

\NormalTok{knitr}\OperatorTok{::}\KeywordTok{kable}\NormalTok{(table_num, }\DataTypeTok{row.names=}\OtherTok{FALSE}\NormalTok{, }\DataTypeTok{align=}\KeywordTok{c}\NormalTok{(}\StringTok{"l"}\NormalTok{, }\StringTok{"l"}\NormalTok{, }\StringTok{"r"}\NormalTok{, }\StringTok{"r"}\NormalTok{, }\StringTok{"r"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}llrrr@{}}
\toprule
Dependent: over\_surv\_stt & & DECEASED & LIVING & p\tabularnewline
\midrule
\endhead
age & Mean (SD) & 64.2 (12.0) & 58.8 (11.9) &
\textless{}0.001\tabularnewline
disease\_free\_mth & Mean (SD) & 16.4 (18.2) & 45.5 (31.5) &
\textless{}0.001\tabularnewline
frac\_genome\_alter & Mean (SD) & 0.2 (0.2) & 0.2 (0.2) &
0.230\tabularnewline
year\_diagnose & Mean (SD) & 2004.6 (2.4) & 2006.7 (2.7) &
\textless{}0.001\tabularnewline
long\_dim & Mean (SD) & 1.8 (0.6) & 1.6 (0.7) &
\textless{}0.001\tabularnewline
mutation\_cnt & Mean (SD) & 60.5 (90.9) & 80.7 (142.7) &
0.111\tabularnewline
over\_surv\_mth & Mean (SD) & 31.6 (25.1) & 50.5 (33.6) &
\textless{}0.001\tabularnewline
short\_dim & Mean (SD) & 0.4 (0.2) & 0.4 (0.2) & 0.631\tabularnewline
second\_long\_dim & Mean (SD) & 1.0 (0.3) & 0.9 (0.3) &
\textless{}0.001\tabularnewline
\bottomrule
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Correlation Matrix}
\CommentTok{# Pearson's (normal distribution) or Spearman (not-normal) correlations}
\NormalTok{corr_num <-}\StringTok{ }\NormalTok{kirc_clin }\OperatorTok{%>%}
\StringTok{     }\KeywordTok{select_if}\NormalTok{(is.numeric) }\OperatorTok{%>%}
\StringTok{     }\KeywordTok{drop_na}\NormalTok{()}

\CommentTok{# Check the correlation between variables to exclude the higly correlated}
\NormalTok{cor_matrix <-}\StringTok{ }\KeywordTok{cor}\NormalTok{(corr_num, }\DataTypeTok{method =} \StringTok{"spearman"}\NormalTok{)}
\NormalTok{cor_matrix <-}\StringTok{ }\KeywordTok{round}\NormalTok{(cor_matrix, }\DecValTok{2}\NormalTok{)}
\NormalTok{cor_matrix}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                     age disease_free_mth frac_genome_alter year_diagnose
## age                1.00            -0.06              0.17         -0.03
## disease_free_mth  -0.06             1.00             -0.05         -0.32
## frac_genome_alter  0.17            -0.05              1.00         -0.04
## year_diagnose     -0.03            -0.32             -0.04          1.00
## long_dim           0.03             0.02              0.05         -0.29
## mutation_cnt       0.26            -0.03              0.23          0.04
## over_surv_mth     -0.02             0.83             -0.02         -0.45
## short_dim          0.06             0.06             -0.03         -0.19
## second_long_dim    0.02            -0.02             -0.02         -0.06
##                   long_dim mutation_cnt over_surv_mth short_dim second_long_dim
## age                   0.03         0.26         -0.02      0.06            0.02
## disease_free_mth      0.02        -0.03          0.83      0.06           -0.02
## frac_genome_alter     0.05         0.23         -0.02     -0.03           -0.02
## year_diagnose        -0.29         0.04         -0.45     -0.19           -0.06
## long_dim              1.00        -0.05          0.14      0.37            0.34
## mutation_cnt         -0.05         1.00         -0.02      0.11           -0.10
## over_surv_mth         0.14        -0.02          1.00      0.14           -0.01
## short_dim             0.37         0.11          0.14      1.00           -0.07
## second_long_dim       0.34        -0.10         -0.01     -0.07            1.00
\end{verbatim}

\subsection{5. Categorical variables
vs.~over\_surv\_stt}\label{categorical-variables-vs.over_surv_stt}

Tabulation and chi-square test

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# t_metas_stg <- table(kirc_clin$metastasis_stg, kirc_clin$over_surv_stt, exclude = NULL)}
\CommentTok{# t_metas_stg <- addmargins(round(100*prop.table(t_metas_stg)))}
\CommentTok{# t_metas_stg}
\CommentTok{# chisq.test(x = kirc_clin$metastasis_stg, y = kirc_clin$over_surv_stt) }
\end{Highlighting}
\end{Shaded}

Summary for chategorical explanatory variables Chi-squared warnings will
be generated when the expected count in any cell is less than 5.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{explanatory_char <-}\StringTok{ }\NormalTok{kirc_clin }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{select}\NormalTok{(}\OperatorTok{-}\NormalTok{over_surv_stt) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{select_if}\NormalTok{(is.factor) }\OperatorTok{%>%}
\StringTok{  }\NormalTok{names}

\NormalTok{dependent <-}\StringTok{  'over_surv_stt'}

\NormalTok{table_char <-}\StringTok{ }\NormalTok{kirc_clin }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{summary_factorlist}\NormalTok{(dependent, explanatory_char, }\DataTypeTok{p=}\OtherTok{TRUE}\NormalTok{, }
                     \DataTypeTok{add_dependent_label=}\OtherTok{TRUE}\NormalTok{,  }\DataTypeTok{na_include =} \OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in chisq.test(tumor_stg, over_surv_stt): Chi-squared approximation may
## be incorrect
\end{verbatim}

\begin{verbatim}
## Warning in chisq.test(histology_grd, over_surv_stt): Chi-squared approximation
## may be incorrect
\end{verbatim}

\begin{verbatim}
## Warning in chisq.test(hemoglobin, over_surv_stt): Chi-squared approximation may
## be incorrect
\end{verbatim}

\begin{verbatim}
## Warning in chisq.test(tumor_lateral, over_surv_stt): Chi-squared approximation
## may be incorrect
\end{verbatim}

\begin{verbatim}
## Warning in chisq.test(race, over_surv_stt): Chi-squared approximation may be
## incorrect
\end{verbatim}

\begin{verbatim}
## Warning in chisq.test(serum_ca, over_surv_stt): Chi-squared approximation may be
## incorrect
\end{verbatim}

\begin{verbatim}
## Warning in chisq.test(wbc, over_surv_stt): Chi-squared approximation may be
## incorrect
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{knitr}\OperatorTok{::}\KeywordTok{kable}\NormalTok{(table_char, }\DataTypeTok{row.names=}\OtherTok{FALSE}\NormalTok{, }\DataTypeTok{align=}\KeywordTok{c}\NormalTok{(}\StringTok{"l"}\NormalTok{, }\StringTok{"l"}\NormalTok{, }\StringTok{"r"}\NormalTok{, }\StringTok{"r"}\NormalTok{, }\StringTok{"r"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}llrrr@{}}
\toprule
Dependent: over\_surv\_stt & & DECEASED & LIVING & p\tabularnewline
\midrule
\endhead
metastasis\_stg & M0 & 110 (62.1) & 316 (87.8) &
\textless{}0.001\tabularnewline
& M1 & 64 (36.2) & 15 (4.2) &\tabularnewline
& MX & 3 (1.7) & 27 (7.5) &\tabularnewline
& (Missing) & 0 (0.0) & 2 (0.6) &\tabularnewline
neoplasm\_ln\_stg & N0 & 85 (48.0) & 155 (43.1) & 0.001\tabularnewline
& N1 & 12 (6.8) & 5 (1.4) &\tabularnewline
& NX & 80 (45.2) & 200 (55.6) &\tabularnewline
neoplasm\_stg & Stage I & 45 (25.4) & 224 (62.2) &
\textless{}0.001\tabularnewline
& Stage II & 13 (7.3) & 44 (12.2) &\tabularnewline
& Stage III & 51 (28.8) & 74 (20.6) &\tabularnewline
& Stage IV & 67 (37.9) & 16 (4.4) &\tabularnewline
& (Missing) & 1 (0.6) & 2 (0.6) &\tabularnewline
tumor\_stg & T1 & 50 (28.2) & 225 (62.5) &
\textless{}0.001\tabularnewline
& T2 & 21 (11.9) & 48 (13.3) &\tabularnewline
& T3 & 96 (54.2) & 86 (23.9) &\tabularnewline
& T4 & 10 (5.6) & 1 (0.3) &\tabularnewline
disease\_free\_stt & DiseaseFree & 0 (0.0) & 311 (86.4) &
\textless{}0.001\tabularnewline
& Recurred/Progressed & 78 (44.1) & 49 (13.6) &\tabularnewline
& (Missing) & 99 (55.9) & 0 (0.0) &\tabularnewline
ethnicity & hispanic/latino & 3 (1.7) & 23 (6.4) & 0.017\tabularnewline
& not hispanic/latino & 132 (74.6) & 227 (63.1) &\tabularnewline
& (Missing) & 42 (23.7) & 110 (30.6) &\tabularnewline
histology\_grd & G1 & 0 (0.0) & 14 (3.9) &
\textless{}0.001\tabularnewline
& G2 & 45 (25.4) & 185 (51.4) &\tabularnewline
& G3 & 74 (41.8) & 133 (36.9) &\tabularnewline
& G4 & 57 (32.2) & 21 (5.8) &\tabularnewline
& GX & 1 (0.6) & 4 (1.1) &\tabularnewline
& (Missing) & 0 (0.0) & 3 (0.8) &\tabularnewline
hemoglobin & Elevated & 3 (1.7) & 2 (0.6) &
\textless{}0.001\tabularnewline
& Low & 118 (66.7) & 145 (40.3) &\tabularnewline
& Normal & 43 (24.3) & 143 (39.7) &\tabularnewline
& (Missing) & 13 (7.3) & 70 (19.4) &\tabularnewline
neoadj\_therapy & No & 167 (94.4) & 352 (97.8) & 0.069\tabularnewline
& Yes & 10 (5.6) & 8 (2.2) &\tabularnewline
prior\_cancer & No & 153 (86.4) & 306 (85.0) & 0.753\tabularnewline
& Yes & 24 (13.6) & 54 (15.0) &\tabularnewline
tumor\_lateral & Bilateral & 0 (0.0) & 1 (0.3) & 0.023\tabularnewline
& Left & 98 (55.4) & 155 (43.1) &\tabularnewline
& Right & 79 (44.6) & 204 (56.7) &\tabularnewline
primer\_ln\_ind3 & NO & 120 (67.8) & 275 (76.4) & 0.024\tabularnewline
& YES & 56 (31.6) & 79 (21.9) &\tabularnewline
& (Missing) & 1 (0.6) & 6 (1.7) &\tabularnewline
platelet & Elevated & 30 (16.9) & 8 (2.2) &
\textless{}0.001\tabularnewline
& Low & 20 (11.3) & 26 (7.2) &\tabularnewline
& Normal & 108 (61.0) & 252 (70.0) &\tabularnewline
& (Missing) & 19 (10.7) & 74 (20.6) &\tabularnewline
tissue\_prospect & NO & 169 (95.5) & 296 (82.2) &
\textless{}0.001\tabularnewline
& YES & 2 (1.1) & 50 (13.9) &\tabularnewline
& (Missing) & 6 (3.4) & 14 (3.9) &\tabularnewline
race & Asian & 1 (0.6) & 7 (1.9) & 0.032\tabularnewline
& Black/African.american & 11 (6.2) & 45 (12.5) &\tabularnewline
& White & 163 (92.1) & 303 (84.2) &\tabularnewline
& (Missing) & 2 (1.1) & 5 (1.4) &\tabularnewline
tissue\_retrospect & NO & 2 (1.1) & 51 (14.2) &
\textless{}0.001\tabularnewline
& YES & 169 (95.5) & 297 (82.5) &\tabularnewline
& (Missing) & 6 (3.4) & 12 (3.3) &\tabularnewline
serum\_ca & Elevated & 9 (5.1) & 1 (0.3) & 0.001\tabularnewline
& Low & 66 (37.3) & 138 (38.3) &\tabularnewline
& Normal & 62 (35.0) & 89 (24.7) &\tabularnewline
& (Missing) & 40 (22.6) & 132 (36.7) &\tabularnewline
gender & Female & 65 (36.7) & 126 (35.0) & 0.767\tabularnewline
& Male & 112 (63.3) & 234 (65.0) &\tabularnewline
tissue\_site & A & 11 (6.2) & 68 (18.9) &
\textless{}0.001\tabularnewline
& B & 112 (63.3) & 191 (53.1) &\tabularnewline
& C & 49 (27.7) & 78 (21.7) &\tabularnewline
& OTHERS & 5 (2.8) & 23 (6.4) &\tabularnewline
person\_neoplasm\_stt & Tumor.Free & 57 (32.2) & 304 (84.4) &
\textless{}0.001\tabularnewline
& With.Tumor & 105 (59.3) & 36 (10.0) &\tabularnewline
& (Missing) & 15 (8.5) & 20 (5.6) &\tabularnewline
wbc & Elevated & 46 (26.0) & 118 (32.8) & 0.011\tabularnewline
& Low & 6 (3.4) & 3 (0.8) &\tabularnewline
& Normal & 104 (58.8) & 164 (45.6) &\tabularnewline
& (Missing) & 21 (11.9) & 75 (20.8) &\tabularnewline
\bottomrule
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Droping levels with narrow distributions -> check warnings ()}
\CommentTok{# Group some levels or drop one (NULL = 'level') when grouping is not possible  }

\NormalTok{kirc_clin2 <-}\StringTok{ }\NormalTok{kirc_clin }\OperatorTok{%>%}
\StringTok{     }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{neoplasm_stg =} \KeywordTok{fct_collapse}\NormalTok{(neoplasm_stg, }\StringTok{'Stage I-II'}\NormalTok{ =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{'Stage I'}\NormalTok{,}\StringTok{'Stage II'}\NormalTok{), }\StringTok{'Stage III-IV'}\NormalTok{ =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{'Stage III'}\NormalTok{,}\StringTok{'Stage IV'}\NormalTok{)),}
            \DataTypeTok{tumor_stg =} \KeywordTok{fct_collapse}\NormalTok{(tumor_stg, }\StringTok{'T1-T2'}\NormalTok{ =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{'T1'}\NormalTok{,}\StringTok{'T2'}\NormalTok{), }\StringTok{'T3-T4'}\NormalTok{ =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{'T3'}\NormalTok{,}\StringTok{'T4'}\NormalTok{)),}
            \DataTypeTok{histology_grd =} \KeywordTok{fct_collapse}\NormalTok{(histology_grd, }\StringTok{'G1-G2'}\NormalTok{ =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{'G1'}\NormalTok{,}\StringTok{'G2'}\NormalTok{), }\StringTok{'G3-G4'}\NormalTok{ =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{'G3'}\NormalTok{,}\StringTok{'G4'}\NormalTok{)),}
            \DataTypeTok{hemoglobin =} \KeywordTok{fct_collapse}\NormalTok{(hemoglobin, }\StringTok{'Not.Low'}\NormalTok{ =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{'Normal'}\NormalTok{, }\StringTok{'Elevated'}\NormalTok{)),}
            \DataTypeTok{serum_ca =} \KeywordTok{fct_collapse}\NormalTok{(serum_ca, }\StringTok{'Not.Low'}\NormalTok{ =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{'Normal'}\NormalTok{, }\StringTok{'Elevated'}\NormalTok{)),}
            \DataTypeTok{wbc =} \KeywordTok{fct_collapse}\NormalTok{(wbc, }\StringTok{'Not.Elevated'}\NormalTok{ =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{'Low'}\NormalTok{, }\StringTok{'Normal'}\NormalTok{)))}
                                                       
\NormalTok{kirc_clin2 <-}\StringTok{ }\NormalTok{kirc_clin }\OperatorTok{%>%}
\StringTok{     }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{histology_grd =} \KeywordTok{fct_recode}\NormalTok{(histology_grd,  }\DataTypeTok{NULL =} \StringTok{'GX'}\NormalTok{),}
            \DataTypeTok{tumor_lateral =} \KeywordTok{fct_recode}\NormalTok{(tumor_lateral, }\DataTypeTok{NULL =} \StringTok{'Bilateral'}\NormalTok{),}
            \DataTypeTok{race =} \KeywordTok{fct_recode}\NormalTok{(race, }\DataTypeTok{NULL =} \StringTok{'Asian'}\NormalTok{))}


\NormalTok{table_char2 <-}\StringTok{ }\NormalTok{kirc_clin2 }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{summary_factorlist}\NormalTok{(dependent, explanatory_char, }\DataTypeTok{p=}\OtherTok{TRUE}\NormalTok{, }
                     \DataTypeTok{add_dependent_label=}\OtherTok{TRUE}\NormalTok{,  }\DataTypeTok{na_include =} \OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in chisq.test(tumor_stg, over_surv_stt): Chi-squared approximation may
## be incorrect
\end{verbatim}

\begin{verbatim}
## Warning in chisq.test(histology_grd, over_surv_stt): Chi-squared approximation
## may be incorrect
\end{verbatim}

\begin{verbatim}
## Warning in chisq.test(hemoglobin, over_surv_stt): Chi-squared approximation may
## be incorrect
\end{verbatim}

\begin{verbatim}
## Warning in chisq.test(serum_ca, over_surv_stt): Chi-squared approximation may be
## incorrect
\end{verbatim}

\begin{verbatim}
## Warning in chisq.test(wbc, over_surv_stt): Chi-squared approximation may be
## incorrect
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{knitr}\OperatorTok{::}\KeywordTok{kable}\NormalTok{(table_char2, }\DataTypeTok{row.names=}\OtherTok{FALSE}\NormalTok{, }\DataTypeTok{align=}\KeywordTok{c}\NormalTok{(}\StringTok{"l"}\NormalTok{, }\StringTok{"l"}\NormalTok{, }\StringTok{"r"}\NormalTok{, }\StringTok{"r"}\NormalTok{, }\StringTok{"r"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}llrrr@{}}
\toprule
Dependent: over\_surv\_stt & & DECEASED & LIVING & p\tabularnewline
\midrule
\endhead
metastasis\_stg & M0 & 110 (62.1) & 316 (87.8) &
\textless{}0.001\tabularnewline
& M1 & 64 (36.2) & 15 (4.2) &\tabularnewline
& MX & 3 (1.7) & 27 (7.5) &\tabularnewline
& (Missing) & 0 (0.0) & 2 (0.6) &\tabularnewline
neoplasm\_ln\_stg & N0 & 85 (48.0) & 155 (43.1) & 0.001\tabularnewline
& N1 & 12 (6.8) & 5 (1.4) &\tabularnewline
& NX & 80 (45.2) & 200 (55.6) &\tabularnewline
neoplasm\_stg & Stage I & 45 (25.4) & 224 (62.2) &
\textless{}0.001\tabularnewline
& Stage II & 13 (7.3) & 44 (12.2) &\tabularnewline
& Stage III & 51 (28.8) & 74 (20.6) &\tabularnewline
& Stage IV & 67 (37.9) & 16 (4.4) &\tabularnewline
& (Missing) & 1 (0.6) & 2 (0.6) &\tabularnewline
tumor\_stg & T1 & 50 (28.2) & 225 (62.5) &
\textless{}0.001\tabularnewline
& T2 & 21 (11.9) & 48 (13.3) &\tabularnewline
& T3 & 96 (54.2) & 86 (23.9) &\tabularnewline
& T4 & 10 (5.6) & 1 (0.3) &\tabularnewline
disease\_free\_stt & DiseaseFree & 0 (0.0) & 311 (86.4) &
\textless{}0.001\tabularnewline
& Recurred/Progressed & 78 (44.1) & 49 (13.6) &\tabularnewline
& (Missing) & 99 (55.9) & 0 (0.0) &\tabularnewline
ethnicity & hispanic/latino & 3 (1.7) & 23 (6.4) & 0.017\tabularnewline
& not hispanic/latino & 132 (74.6) & 227 (63.1) &\tabularnewline
& (Missing) & 42 (23.7) & 110 (30.6) &\tabularnewline
histology\_grd & G1 & 0 (0.0) & 14 (3.9) &
\textless{}0.001\tabularnewline
& G2 & 45 (25.4) & 185 (51.4) &\tabularnewline
& G3 & 74 (41.8) & 133 (36.9) &\tabularnewline
& G4 & 57 (32.2) & 21 (5.8) &\tabularnewline
& (Missing) & 1 (0.6) & 7 (1.9) &\tabularnewline
hemoglobin & Elevated & 3 (1.7) & 2 (0.6) &
\textless{}0.001\tabularnewline
& Low & 118 (66.7) & 145 (40.3) &\tabularnewline
& Normal & 43 (24.3) & 143 (39.7) &\tabularnewline
& (Missing) & 13 (7.3) & 70 (19.4) &\tabularnewline
neoadj\_therapy & No & 167 (94.4) & 352 (97.8) & 0.069\tabularnewline
& Yes & 10 (5.6) & 8 (2.2) &\tabularnewline
prior\_cancer & No & 153 (86.4) & 306 (85.0) & 0.753\tabularnewline
& Yes & 24 (13.6) & 54 (15.0) &\tabularnewline
tumor\_lateral & Left & 98 (55.4) & 155 (43.1) & 0.010\tabularnewline
& Right & 79 (44.6) & 204 (56.7) &\tabularnewline
& (Missing) & 0 (0.0) & 1 (0.3) &\tabularnewline
primer\_ln\_ind3 & NO & 120 (67.8) & 275 (76.4) & 0.024\tabularnewline
& YES & 56 (31.6) & 79 (21.9) &\tabularnewline
& (Missing) & 1 (0.6) & 6 (1.7) &\tabularnewline
platelet & Elevated & 30 (16.9) & 8 (2.2) &
\textless{}0.001\tabularnewline
& Low & 20 (11.3) & 26 (7.2) &\tabularnewline
& Normal & 108 (61.0) & 252 (70.0) &\tabularnewline
& (Missing) & 19 (10.7) & 74 (20.6) &\tabularnewline
tissue\_prospect & NO & 169 (95.5) & 296 (82.2) &
\textless{}0.001\tabularnewline
& YES & 2 (1.1) & 50 (13.9) &\tabularnewline
& (Missing) & 6 (3.4) & 14 (3.9) &\tabularnewline
race & Black/African.american & 11 (6.2) & 45 (12.5) &
0.032\tabularnewline
& White & 163 (92.1) & 303 (84.2) &\tabularnewline
& (Missing) & 3 (1.7) & 12 (3.3) &\tabularnewline
tissue\_retrospect & NO & 2 (1.1) & 51 (14.2) &
\textless{}0.001\tabularnewline
& YES & 169 (95.5) & 297 (82.5) &\tabularnewline
& (Missing) & 6 (3.4) & 12 (3.3) &\tabularnewline
serum\_ca & Elevated & 9 (5.1) & 1 (0.3) & 0.001\tabularnewline
& Low & 66 (37.3) & 138 (38.3) &\tabularnewline
& Normal & 62 (35.0) & 89 (24.7) &\tabularnewline
& (Missing) & 40 (22.6) & 132 (36.7) &\tabularnewline
gender & Female & 65 (36.7) & 126 (35.0) & 0.767\tabularnewline
& Male & 112 (63.3) & 234 (65.0) &\tabularnewline
tissue\_site & A & 11 (6.2) & 68 (18.9) &
\textless{}0.001\tabularnewline
& B & 112 (63.3) & 191 (53.1) &\tabularnewline
& C & 49 (27.7) & 78 (21.7) &\tabularnewline
& OTHERS & 5 (2.8) & 23 (6.4) &\tabularnewline
person\_neoplasm\_stt & Tumor.Free & 57 (32.2) & 304 (84.4) &
\textless{}0.001\tabularnewline
& With.Tumor & 105 (59.3) & 36 (10.0) &\tabularnewline
& (Missing) & 15 (8.5) & 20 (5.6) &\tabularnewline
wbc & Elevated & 46 (26.0) & 118 (32.8) & 0.011\tabularnewline
& Low & 6 (3.4) & 3 (0.8) &\tabularnewline
& Normal & 104 (58.8) & 164 (45.6) &\tabularnewline
& (Missing) & 21 (11.9) & 75 (20.8) &\tabularnewline
\bottomrule
\end{longtable}

\subsection{Further analysis}\label{further-analysis}

\begin{itemize}
\tightlist
\item
  \href{3.logistic_regression.md}{A logistic regression analysis} of
  each clinical variable weight.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{sessionInfo}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## R version 3.6.3 (2020-02-29)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS Mojave 10.14.6
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] pt_BR.UTF-8/pt_BR.UTF-8/pt_BR.UTF-8/C/pt_BR.UTF-8/pt_BR.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] plotly_4.9.2.1  GGally_1.5.0    ggpubr_0.2.5    magrittr_1.5   
##  [5] rstatix_0.6.0   finalfit_1.0.2  skimr_2.1.1     forcats_0.5.0  
##  [9] stringr_1.4.0   dplyr_0.8.5     purrr_0.3.3     readr_1.3.1    
## [13] tidyr_1.0.2     tibble_3.0.0    ggplot2_3.3.0   tidyverse_1.3.0
## 
## loaded via a namespace (and not attached):
##  [1] nlme_3.1-145       fs_1.4.1           lubridate_1.7.8    RColorBrewer_1.1-2
##  [5] httr_1.4.1         ggsci_2.9          repr_1.1.0         tools_3.6.3       
##  [9] backports_1.1.6    utf8_1.1.4         R6_2.4.1           mgcv_1.8-31       
## [13] DBI_1.1.0          lazyeval_0.2.2     colorspace_1.4-1   withr_2.1.2       
## [17] tidyselect_1.0.0   curl_4.3           compiler_3.6.3     cli_2.0.2         
## [21] rvest_0.3.5        mice_3.8.0         xml2_1.3.0         labeling_0.3      
## [25] scales_1.1.0       digest_0.6.25      foreign_0.8-76     rmarkdown_2.1     
## [29] rio_0.5.16         base64enc_0.1-3    pkgconfig_2.0.3    htmltools_0.4.0   
## [33] highr_0.8          dbplyr_1.4.2       htmlwidgets_1.5.1  rlang_0.4.5       
## [37] readxl_1.3.1       rstudioapi_0.11    generics_0.0.2     farver_2.0.3      
## [41] jsonlite_1.6.1     zip_2.0.4          car_3.0-7          Matrix_1.2-18     
## [45] Rcpp_1.0.4         munsell_0.5.0      fansi_0.4.1        abind_1.4-5       
## [49] lifecycle_0.2.0    stringi_1.4.6      yaml_2.2.1         carData_3.0-3     
## [53] plyr_1.8.6         grid_3.6.3         crayon_1.3.4       lattice_0.20-41   
## [57] haven_2.2.0        splines_3.6.3      hms_0.5.3          knitr_1.28        
## [61] pillar_1.4.3       boot_1.3-24        ggsignif_0.6.0     reprex_0.3.0      
## [65] glue_1.4.0         evaluate_0.14      data.table_1.12.8  modelr_0.1.6      
## [69] vctrs_0.2.4        cellranger_1.1.0   gtable_0.3.0       reshape_0.8.8     
## [73] assertthat_0.2.1   xfun_0.12          openxlsx_4.1.4     broom_0.7.0       
## [77] survival_3.2-3     viridisLite_0.3.0  ellipsis_0.3.0
\end{verbatim}

\end{document}
